@using Sandbox;
@using Sandbox.UI;

@namespace Facepunch.Gunfight.UI

<root class="@RootClasses()">
    @if ( Client.IsValid() )
    {
        <img class="avatar" src="avatar:@Client.PlayerId" />
        <label class="name">@Client.Name</label>
        <label class="kills">@Client.GetValue( "frags", 0 )</label>
        <label class="deaths">@Client.GetValue( "deaths", 0 )</label>
        <label class="score">@Client.GetValue( "score", 0 )</label>
        <label class="ping">@Client.Ping</label>
    }
    else
    {
        <label class="loading">...</label>
    }
</root>

@code
{
    Client Client { get; set; }

    public void SetClient( Client cl )
    {
        Client = cl;
        SetClass( "me", cl == Local.Client );

        StateHasChanged();
    }

	public string RootClasses()
	{
		var cl = Client.All.FirstOrDefault( x => x.PlayerId == Client.PlayerId );
		if ( cl == null ) return "disconnected";

		var friendState = TeamSystem.GetFriendState( cl.GetTeam(), TeamSystem.MyTeam );

		if ( friendState == TeamSystem.FriendlyStatus.Friendly ) return "friend";
		if ( friendState == TeamSystem.FriendlyStatus.Hostile ) return "enemy";
		if ( friendState == TeamSystem.FriendlyStatus.Neutral ) return "neutral";

		return "";
	}
}
